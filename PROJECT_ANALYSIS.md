# Lifeclover í”„ë¡œì íŠ¸ ì¢…í•© ë¶„ì„ ë¬¸ì„œ

## ðŸ“‹ í”„ë¡œì íŠ¸ ê°œìš”

**Lifeclover**ëŠ” RAG(Retrieval-Augmented Generation) + LLM ê¸°ë°˜ì˜ ì±—ë´‡ê³¼ ë‹¤ì´ì–´ë¦¬ ì„œë¹„ìŠ¤ë¥¼ ì œê³µí•˜ëŠ” ì›¹ ì• í”Œë¦¬ì¼€ì´ì…˜ìž…ë‹ˆë‹¤.

Well Dying ì •ì‹ ì„ ë°”íƒ•ìœ¼ë¡œ Well Lifeë¥¼ ì„ ì‚¬í•˜ëŠ” ì„œë¹„ìŠ¤ ìž…ë‹ˆë‹¤.

---

## ðŸ—ï¸ í”„ë¡œì íŠ¸ êµ¬ì¡°

```
Lifeclover-ui/
â”œâ”€â”€ chatbot/                    # ì±—ë´‡ í•µì‹¬ ëª¨ë“ˆ
â”‚   â”œâ”€â”€ conversation_engine.py  # LangGraph ê¸°ë°˜ ëŒ€í™” ì—”ì§„
â”‚   â”œâ”€â”€ chatbot_modules/
â”‚   â”‚   â”œâ”€â”€ llm_client.py       # OpenAI LLM í´ë¼ì´ì–¸íŠ¸
â”‚   â”‚   â”œâ”€â”€ empathy_agent.py     # ê°ì„± ëŒ€í™” ì—ì´ì „íŠ¸ (ê³µê° ëª¨ë“œ)
â”‚   â”‚   â”œâ”€â”€ info_agent.py       # ì •ë³´ ì œê³µ ì—ì´ì „íŠ¸ (ì •ë³´ ëª¨ë“œ)
â”‚   â”‚   â”œâ”€â”€ session_manager.py  # ì‚¬ìš©ìž ì„¸ì…˜ ë° ëŒ€í™” ê¸°ë¡ ê´€ë¦¬
â”‚   â”‚   â”œâ”€â”€ diary_manager.py    # ë‹¤ì´ì–´ë¦¬ ìƒì„± ë° ê´€ë¦¬
â”‚   â”‚   â””â”€â”€ recommend_ba.py    # RAG ë„êµ¬ (Pinecone, Tavily)
â”‚   â””â”€â”€ sessions/               # ì„¸ì…˜ ë° ë‹¤ì´ì–´ë¦¬ ì €ìž¥ì†Œ
â”‚
â”œâ”€â”€ config/                     # Django ì„¤ì •
â”‚   â”œâ”€â”€ settings.py
â”‚   â”œâ”€â”€ urls.py
â”‚   â””â”€â”€ ...
â”‚
â”œâ”€â”€ web/                        # Django ì•±
â”‚   â””â”€â”€ views.py                # API ì—”ë“œí¬ì¸íŠ¸
â”‚
â”œâ”€â”€ templates/                  # HTML í…œí”Œë¦¿
â”‚   â”œâ”€â”€ base.html
â”‚   â””â”€â”€ index.html
â”‚
â”œâ”€â”€ static/                     # ì •ì  íŒŒì¼
â”‚   â”œâ”€â”€ css/style.css
â”‚   â”œâ”€â”€ js/app.js
â”‚   â””â”€â”€ img/
â”‚
â”œâ”€â”€ data/                       # ë°ì´í„° íŒŒì¼
â”‚   â”œâ”€â”€ conversation_rules.json
â”‚   â”œâ”€â”€ empathy_questions.csv
â”‚   â”œâ”€â”€ facilities_region_list.json
â”‚   â””â”€â”€ ...
â”‚
â””â”€â”€ requirements.txt            # Python ì˜ì¡´ì„±
```

---

## ðŸ”§ ì‚¬ìš©ëœ ë¼ì´ë¸ŒëŸ¬ë¦¬ ë° ê¸°ìˆ  ìŠ¤íƒ

### Backend (Python/Django)
- **Django** (>=5.0, <6.0): ì›¹ í”„ë ˆìž„ì›Œí¬
- **LangChain**: LLM í†µí•© ë° ì²´ì¸ êµ¬ì„±
- **LangGraph**: ëŒ€í™” íë¦„ ê´€ë¦¬ (StateGraph)
- **OpenAI** (GPT-4o): LLM ëª¨ë¸
- **Pinecone**: ë²¡í„° DB (RAG ê²€ìƒ‰)
- **Tavily**: ì‹¤ì‹œê°„ ì›¹ ê²€ìƒ‰
- **python-dotenv**: í™˜ê²½ ë³€ìˆ˜ ê´€ë¦¬

### Frontend
- **Vanilla JavaScript**: ìˆœìˆ˜ JS (í”„ë ˆìž„ì›Œí¬ ì—†ìŒ)
- **Django Templates**: ì„œë²„ ì‚¬ì´ë“œ ë Œë”ë§
- **CSS**: ì»¤ìŠ¤í…€ ìŠ¤íƒ€ì¼ì‹œíŠ¸

### ë°ì´í„°ë² ì´ìŠ¤
- **SQLite**: Django ê¸°ë³¸ DB (ì‚¬ìš©ìž ì„¸ì…˜ì€ JSON íŒŒì¼ë¡œ ì €ìž¥)

---

## ðŸš€ ì‹¤í–‰ ë°©ë²•

### 1. í™˜ê²½ ì„¤ì •

```bash
# ì½˜ë‹¤ ê°€ìƒí™˜ê²½ í™œì„±í™”
conda activate ml_env

# í”„ë¡œì íŠ¸ ë””ë ‰í† ë¦¬ë¡œ ì´ë™
cd Lifeclover-ui

# ì˜ì¡´ì„± ì„¤ì¹˜
pip install -r requirements.txt
```

### 2. í™˜ê²½ ë³€ìˆ˜ ì„¤ì •

í”„ë¡œì íŠ¸ ë£¨íŠ¸ì— `.env` íŒŒì¼ ìƒì„±:

```env
OPENAI_API_KEY=your_openai_api_key
PINECONE_API_KEY=your_pinecone_api_key
TAVILY_API_KEY=your_tavily_api_key
```

### 3. Django ì„œë²„ ì‹¤í–‰

```bash
# ë§ˆì´ê·¸ë ˆì´ì…˜ (í•„ìš”ì‹œ)
python manage.py migrate

# ì„œë²„ ì‹¤í–‰
python manage.py runserver
```

ê¸°ë³¸ ì£¼ì†Œ: `http://127.0.0.1:8000/`

**ì°¸ê³ **: `settings.py`ì—ì„œ `ALLOWED_HOSTS = ["192.168.0.28"]`ë¡œ ì„¤ì •ë˜ì–´ ìžˆì–´, ë‹¤ë¥¸ IPì—ì„œ ì ‘ê·¼í•˜ë ¤ë©´ ìˆ˜ì • í•„ìš”

---

## ðŸŽ¯ ì£¼ìš” ê¸°ëŠ¥ ì„¤ëª…

### 1. ì±—ë´‡ ì‹œìŠ¤í…œ (LangGraph ê¸°ë°˜)

#### ë‘ ê°€ì§€ ëª¨ë“œ

**A. ê°ì„± ëŒ€í™” ëª¨ë“œ (`empathy_agent`)**
- ì‚¬ìš©ìžì˜ ê°ì •ì„ ê³µê°í•˜ê³  ìœ„ë¡œí•˜ëŠ” ëª¨ë“œ
- ì§„ì§€í•¨ ì ìˆ˜(seriousness_score)ì— ë”°ë¼ ëŒ€í™” í†¤ ì¡°ì ˆ
- ë„êµ¬ ì‚¬ìš©:
  - `recommend_activities_tool`: í™œë™ ì¶”ì²œ (Pinecone RAG)
  - `search_empathy_questions_tool`: ê³µê° ì§ˆë¬¸ ê²€ìƒ‰
  - `search_welldying_wisdom_tool`: ì² í•™ì  ì§€í˜œ ê²€ìƒ‰ (ì§„ì§€í•¨ ì ìˆ˜ ë†’ì„ ë•Œ)
  - `search_realtime_info_tool`: ì‹¤ì‹œê°„ ì •ë³´ ê²€ìƒ‰ (Tavily)

**B. ì •ë³´ ì œê³µ ëª¨ë“œ (`info_agent`)**
- ìž¥ë¡€ ì‹œì„¤, ì§€ì› ì •ì±…, ìœ ì‚° ìƒì†, ë””ì§€í„¸ ì •ë³´ ì œê³µ
- **í˜„ìž¬ ë¯¸êµ¬í˜„ ìƒíƒœ** (Placeholder)

#### ëŒ€í™” íë¦„ (LangGraph)
```
ì‚¬ìš©ìž ë©”ì‹œì§€ ìž…ë ¥
    â†“
ëª¨ë“œ ë¼ìš°íŒ… (chat/info)
    â†“
empathy_agent ë˜ëŠ” info_agent
    â†“
ë„êµ¬ í˜¸ì¶œ í•„ìš” ì‹œ â†’ tools ë…¸ë“œ
    â†“
ì‘ë‹µ ìƒì„± ë° ì €ìž¥
```

### 2. ë‹¤ì´ì–´ë¦¬ ì‹œìŠ¤í…œ

- **ìžë™ ìƒì„±**: ì˜¤ëŠ˜ì˜ ëŒ€í™”ë¥¼ LLMìœ¼ë¡œ ìš”ì•½í•˜ì—¬ ë‹¤ì´ì–´ë¦¬ ìƒì„±
- **ìº˜ë¦°ë” UI**: ë‚ ì§œë³„ ë‹¤ì´ì–´ë¦¬ ì¡°íšŒ
- **ë©”íƒ€ë°ì´í„°**: ì´ëª¨ì§€, í‚¤ì›Œë“œ, ë¯¸ë¦¬ë³´ê¸°

**ìƒì„± í”„ë¡œì„¸ìŠ¤**:
1. ì˜¤ëŠ˜ì˜ ëŒ€í™” ê¸°ë¡ ìˆ˜ì§‘ (`session_manager`)
2. LLMìœ¼ë¡œ ìš”ì•½ ë° ê°ì • ë¶„ì„
3. JSON í˜•ì‹ìœ¼ë¡œ êµ¬ì¡°í™” (emoji, keywords, summary)
4. íŒŒì¼ë¡œ ì €ìž¥ (`sessions/diaries/`)

### 3. ì›¹ UI

**íŽ˜ì´ì§€ êµ¬ì„±**:
- **í™ˆ**: ëžœë”© íŽ˜ì´ì§€
- **ì•Œë ¤ì¤˜ìš”**: ì •ë³´ ì„œë¹„ìŠ¤ ì¹´ë“œ (4ê°€ì§€)
- **ëŒ€í™”í•´ìš”**: ì±—ë´‡ ì¸í„°íŽ˜ì´ìŠ¤
- **ë‹¤ì´ì–´ë¦¬**: ìº˜ë¦°ë” ë° ë‹¤ì´ì–´ë¦¬ ì¡°íšŒ

---

## ðŸ“ ìˆ˜ì •ì´ í•„ìš”í•œ ë¶€ë¶„ ë° ìœ„ì¹˜

### ðŸ”´ ê¸´ê¸‰ ìˆ˜ì • ì‚¬í•­

#### 1. **Info Agent ë¯¸êµ¬í˜„** 
**ìœ„ì¹˜**: `chatbot/chatbot_modules/info_agent.py`
- í˜„ìž¬ ë‹¨ìˆœ í”Œë ˆì´ìŠ¤í™€ë”ë§Œ ìžˆìŒ
- ì •ë³´ ì œê³µ ë¡œì§ êµ¬í˜„ í•„ìš”
- RAG ë„êµ¬ ì—°ë™ í•„ìš” (ìž¥ë¡€ ì‹œì„¤, ì •ì±… ì •ë³´ ë“±)

#### 2. **í”„ë¡¬í”„íŠ¸ ê°œì„  í•„ìš”**
**ìœ„ì¹˜**: `chatbot/chatbot_modules/empathy_agent.py`
- `SYSTEM_PROMPT_TEMPLATE` (54-102ì¤„): í”„ë¡¬í”„íŠ¸ ìˆ˜ì • í•„ìš”
- `INFO_MODE_PROMPT` (8-11ì¤„): ì •ë³´ ëª¨ë“œ í”„ë¡¬í”„íŠ¸ ë³´ì™„ í•„ìš”

#### 3. **í•˜ë“œì½”ë”©ëœ ì‚¬ìš©ìž ID**
**ìœ„ì¹˜**: `web/views.py` (50ì¤„)
```python
user_id = "test_user_01"  # í•˜ë“œì½”ë”©ë¨
```
- ì‹¤ì œ ì‚¬ìš©ìž ì¸ì¦ ì‹œìŠ¤í…œ ì—°ë™ í•„ìš”

#### 4. **í™˜ê²½ ë³€ìˆ˜ ëˆ„ë½ ê°€ëŠ¥ì„±**
**ìœ„ì¹˜**: `chatbot/chatbot_modules/recommend_ba.py`
- Pinecone, Tavily API í‚¤ê°€ ì—†ìœ¼ë©´ ë„êµ¬ ì‚¬ìš© ë¶ˆê°€
- ì—ëŸ¬ í•¸ë“¤ë§ ê°•í™” í•„ìš”

### ðŸŸ¡ ê°œì„  ê¶Œìž¥ ì‚¬í•­

#### 5. **ë‹¤ì´ì–´ë¦¬ ìƒì„± íŠ¸ë¦¬ê±°**
**ìœ„ì¹˜**: `chatbot/conversation_engine.py` (115-116ì¤„)
- í˜„ìž¬ "ë‹¤ì´ì–´ë¦¬" í…ìŠ¤íŠ¸ ìž…ë ¥ìœ¼ë¡œë§Œ íŠ¸ë¦¬ê±°ë¨
- UI ë²„íŠ¼ê³¼ ì—°ë™ í•„ìš”

#### 6. **ì„¸ì…˜ ê´€ë¦¬ ê°œì„ **
**ìœ„ì¹˜**: `chatbot/chatbot_modules/session_manager.py`
- JSON íŒŒì¼ ê¸°ë°˜ ì €ìž¥ â†’ DB ë§ˆì´ê·¸ë ˆì´ì…˜ ê³ ë ¤
- ë™ì‹œì„± ë¬¸ì œ í•´ê²° í•„ìš”

#### 7. **ì—ëŸ¬ í•¸ë“¤ë§**
**ìœ„ì¹˜**: ì „ì—­
- LLM API ì‹¤íŒ¨ ì‹œ fallback ë©”ì»¤ë‹ˆì¦˜ ë¶€ì¡±
- ë„¤íŠ¸ì›Œí¬ ì˜¤ë¥˜ ì²˜ë¦¬ ê°•í™” í•„ìš”

#### 8. **UI/UX ê°œì„ **
**ìœ„ì¹˜**: `static/js/app.js`, `templates/index.html`
- ë¡œë”© ìƒíƒœ í‘œì‹œ ê°œì„ 
- ë°˜ì‘í˜• ë””ìžì¸ ë³´ì™„
- ì ‘ê·¼ì„±(A11y) ê°œì„ 

---

## ðŸ’¡ ê°œì„  ì•„ì´ë””ì–´

### 1. **Info Agent êµ¬í˜„**
- ìž¥ë¡€ ì‹œì„¤ ì •ë³´: `data/facilities_region_list.json` í™œìš©
- ì§€ì› ì •ì±…: `data/ordinance_region_list.json` í™œìš©
- RAG ê²€ìƒ‰ ë„êµ¬ ì¶”ê°€í•˜ì—¬ ì •í™•í•œ ì •ë³´ ì œê³µ

### 2. **í”„ë¡¬í”„íŠ¸ ìµœì í™”**
- **Empathy Agent**: ë” ìžì—°ìŠ¤ëŸ¬ìš´ ê³µê° í‘œí˜„, ë°˜ë³µ íŒ¨í„´ ì œê±°
- **Info Agent**: ì‚¬ì‹¤ ê¸°ë°˜ ë‹µë³€, ì¶œì²˜ ëª…ì‹œ, ë‹¨ê³„ë³„ ì•ˆë‚´

### 3. **ì‚¬ìš©ìž í”„ë¡œí•„ ì‹œìŠ¤í…œ**
- ì´ˆê¸° ì„¤ì • í™”ë©´ ì¶”ê°€
- ì‚¬ìš©ìž ì •ë³´(ì´ë¦„, ë‚˜ì´, ê±°ë™ ìƒíƒœ) ì €ìž¥ ë° í™œìš©
- ìœ„ì¹˜: `web/models.py`ì— User ëª¨ë¸ ì¶”ê°€

### 4. **ë‹¤ì´ì–´ë¦¬ ê¸°ëŠ¥ ê°•í™”**
- ë‹¤ì´ì–´ë¦¬ ìˆ˜ì •/ì‚­ì œ ê¸°ëŠ¥
- ë‹¤ì´ì–´ë¦¬ ê³µìœ  ê¸°ëŠ¥ (ê°€ì¡±ì—ê²Œ)
- ê°ì • ì¶”ì´ ê·¸ëž˜í”„

### 5. **ëŒ€í™” í’ˆì§ˆ ê°œì„ **
- ëŒ€í™” ížˆìŠ¤í† ë¦¬ ìš”ì•½ (í† í° ì ˆì•½)
- ì»¨í…ìŠ¤íŠ¸ ìœˆë„ìš° ê´€ë¦¬
- ì¤‘ë³µ ì‘ë‹µ ë°©ì§€ ë¡œì§

### 6. **ì„±ëŠ¥ ìµœì í™”**
- ìºì‹± ì‹œìŠ¤í…œ ë„ìž… (Redis)
- ë¹„ë™ê¸° ì²˜ë¦¬ (Celery)
- API ì‘ë‹µ ì‹œê°„ ê°œì„ 

### 7. **ë³´ì•ˆ ê°•í™”**
- CSRF í† í° ê²€ì¦
- API Rate Limiting
- ì‚¬ìš©ìž ìž…ë ¥ ê²€ì¦ ë° Sanitization

### 8. **ëª¨ë‹ˆí„°ë§ ë° ë¡œê¹…**
- ëŒ€í™” í’ˆì§ˆ ëª¨ë‹ˆí„°ë§
- ì—ëŸ¬ ì¶”ì  (Sentry ë“±)
- ì‚¬ìš©ìž í–‰ë™ ë¶„ì„

---

## ðŸ“ ì£¼ìš” íŒŒì¼ë³„ ì—­í• 

| íŒŒì¼ | ì—­í•  | ìˆ˜ì • ìš°ì„ ìˆœìœ„ |
|------|------|--------------|
| `chatbot/chatbot_modules/info_agent.py` | ì •ë³´ ì œê³µ ì—ì´ì „íŠ¸ | ðŸ”´ ë†’ìŒ |
| `chatbot/chatbot_modules/empathy_agent.py` | ê°ì„± ëŒ€í™” ì—ì´ì „íŠ¸ | ðŸŸ¡ ì¤‘ê°„ |
| `chatbot/conversation_engine.py` | ëŒ€í™” ì—”ì§„ ë©”ì¸ | ðŸŸ¡ ì¤‘ê°„ |
| `web/views.py` | API ì—”ë“œí¬ì¸íŠ¸ | ðŸŸ¡ ì¤‘ê°„ |
| `chatbot/chatbot_modules/diary_manager.py` | ë‹¤ì´ì–´ë¦¬ ê´€ë¦¬ | ðŸŸ¢ ë‚®ìŒ |
| `static/js/app.js` | í”„ë¡ íŠ¸ì—”ë“œ ë¡œì§ | ðŸŸ¡ ì¤‘ê°„ |
| `templates/index.html` | UI í…œí”Œë¦¿ | ðŸŸ¢ ë‚®ìŒ |

---

## ðŸ” ë””ë²„ê¹… íŒ

### ì±—ë´‡ì´ ì‘ë‹µí•˜ì§€ ì•Šì„ ë•Œ
1. `.env` íŒŒì¼ í™•ì¸ (API í‚¤)
2. `chatbot/conversation_engine.py` ë¡œê·¸ í™•ì¸
3. LangGraph ìƒíƒœ í™•ì¸

### ë‹¤ì´ì–´ë¦¬ê°€ ìƒì„±ë˜ì§€ ì•Šì„ ë•Œ
1. `sessions/test_user_01.json` í™•ì¸ (ëŒ€í™” ê¸°ë¡ ì¡´ìž¬ ì—¬ë¶€)
2. `diary_manager.py`ì˜ í”„ë¡¬í”„íŠ¸ í™•ì¸
3. LLM ì‘ë‹µ í˜•ì‹ í™•ì¸ (JSON íŒŒì‹± ì˜¤ë¥˜ ê°€ëŠ¥)

### Pinecone ì—°ê²° ì˜¤ë¥˜
1. `PINECONE_API_KEY` í™•ì¸
2. ì¸ë±ìŠ¤ ì´ë¦„ í™•ì¸ (`TALK_INDEX_NAME`, `WISDOM_INDEX_NAME`)
3. `recommend_ba.py`ì˜ ì´ˆê¸°í™” ë¡œì§ í™•ì¸

---

## ðŸ“š ì°¸ê³  ìžë£Œ

- [LangGraph ë¬¸ì„œ](https://langchain-ai.github.io/langgraph/)
- [LangChain ë¬¸ì„œ](https://python.langchain.com/)
- [Django ë¬¸ì„œ](https://docs.djangoproject.com/)
- [Pinecone ë¬¸ì„œ](https://docs.pinecone.io/)

---

## âœ… ì²´í¬ë¦¬ìŠ¤íŠ¸

### ì¦‰ì‹œ ìˆ˜ì • í•„ìš”
- [ ] Info Agent êµ¬í˜„
- [ ] í•˜ë“œì½”ë”©ëœ user_id ì œê±°
- [ ] ì—ëŸ¬ í•¸ë“¤ë§ ê°•í™”

### ë‹¨ê¸° ê°œì„ 
- [ ] í”„ë¡¬í”„íŠ¸ ìµœì í™”
- [ ] ë‹¤ì´ì–´ë¦¬ ìƒì„± UI ì—°ë™
- [ ] ì‚¬ìš©ìž ì¸ì¦ ì‹œìŠ¤í…œ

### ìž¥ê¸° ê°œì„ 
- [ ] DB ë§ˆì´ê·¸ë ˆì´ì…˜
- [ ] ì„±ëŠ¥ ìµœì í™”
- [ ] ëª¨ë‹ˆí„°ë§ ì‹œìŠ¤í…œ

---

**ìž‘ì„±ì¼**: 2025-01-XX  
**ìž‘ì„±ìž**: AI Assistant  
**ë²„ì „**: 1.0

